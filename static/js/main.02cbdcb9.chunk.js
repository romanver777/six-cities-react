(this["webpackJsonpsix-sities-react"]=this["webpackJsonpsix-sities-react"]||[]).push([[0],{47:function(e,t,a){e.exports=a(74)},74:function(e,t,a){"use strict";a.r(t);var r=a(20),n=a(14),i=a(0),s=a.n(i),c=a(24),l=a.n(c),o=a(42),m=a(46),u=a(4),p=a(5),d=a(6),_=a(7),f=a(8),h=a(3),v=a(10),g=Object(v.a)(),E=a(30),y={city:"",hotels:[],currentOffer:{},favoriteList:[],isAuthorizationRequired:!0,currentUser:{}},N=function(e,t){var a,r=JSON.parse(localStorage.getItem(e));return r&&(a=r.filter((function(e){return e.currentUser.email===t}))),a},k="SET_CITY",b="LOAD_HOTELS",w="SET_CURRENT_OFFER",O="REQUIRE_AUTHORIZATION",C="SET_CURRENT_USER",L="RELOAD_ALL",j="ADD_FAVORITE",S="REMOVE_FAVORITE",R="SET_FAVORITES",I=function(e){return{type:k,payload:e}},A=function(e){return{type:b,payload:e}},x=function(e){return{type:w,payload:e}},T=function(e){return{type:O,payload:e}},F=function(e){return{type:C,payload:e}},M=function(e,t){var a=function(e,t){return t.length?t.findIndex((function(t){return t.hotelId===e.hotelId})):-1}(e,t);return a<0?{type:"ADD_FAVORITE",payload:e}:{type:"REMOVE_FAVORITE",payload:a}},U=function(e){return{type:"SET_FAVORITES",payload:e}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object.assign({},e,{city:t.payload});case b:return Object.assign({},e,{hotels:t.payload});case w:return Object.assign({},e,{currentOffer:t.payload});case O:return Object.assign({},e,{isAuthorizationRequired:t.payload});case C:return Object.assign({},e,{currentUser:t.payload});case L:return Object.assign({},e);case j:return Object.assign({},e,{favoriteList:[].concat(Object(E.a)(e.favoriteList),[t.payload])});case S:var a=Object(E.a)(e.favoriteList);return a.splice(t.payload,1),Object.assign({},e,{favoriteList:a});case R:return Object.assign({},e,{favoriteList:t.payload});default:return e}},B={loadHotels:function(){return function(e,t,a){return a.get("http://www.mocky.io/v2/5ed64aad340000108a06d8e0").then((function(t){e(A(t.data))}))}},reloadAll:function(){return function(e){return e(B.loadHotels()).then((function(){e(I("Paris"))})),null}},checkAuth:function(){return function(e,t,a){return a.get("/login").then((function(t){if(t.data){e(F(t.data)),e(T(!1));var a=N("favorites",t.data.email);a&&e(U(a[0].favoriteList))}})).catch((function(){}))}},login:function(e){return function(t,a,r){return r.post("/login",e).then((function(e){if(e.data){t(F(e.data)),t(T(!1));var a=N("favorites",e.data.email);a&&t(U(a[0].favoriteList))}})).then((function(){return window.history.back()})).catch((function(){}))}}},q=a(15),H="/login",P="/",z="/offer/:id",D="/favorites",J=a(11),W=a.n(J),X=function(e,t){for(var a=0;a<e.length;a++)if(e[a].city.toLowerCase()===t.toLowerCase())return a},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return{iconUrl:"/img/pin-active.svg",iconSize:[e,t]}},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return{iconUrl:"/img/pin.svg",iconSize:[e,t]}},Q=function(e){var t=[];return e.hotels.forEach((function(e){if(e.offers.length){var a,r=Object(q.a)(e.offers);try{for(r.s();!(a=r.n()).done;){var n=a.value;t.push(n)}}catch(i){r.e(i)}finally{r.f()}}})),t},Z=function(e,t){return Q(e).filter((function(e){return e.hotelId===+t}))[0]},$=function(e,t){var a=Z(e,t).city;return Q(e).filter((function(e){return e.city===a}))},G=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},ee=a(44),te=a(16),ae=a.n(te),re=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleClickToggle=function(){r.setState((function(e){return{isOpen:!e.isOpen}}))},r.handleClick=function(e){var t=r.props.onChangeOption;document.querySelector(".places__option--active").classList.remove("places__option--active"),r.handleClickToggle(),r.setState({option:e.target.innerHTML}),e.target.classList.add("places__option--active"),t(e.target.innerHTML)},r.state={isOpen:!1,option:"Popular"},r}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("form",{className:"places__sorting",action:"#",method:"get"},s.a.createElement("span",{className:"places__sorting-caption"},"Sort by"),s.a.createElement("span",{className:"places__sorting-type",tabIndex:"0",onClick:this.handleClickToggle},this.state.option,s.a.createElement("svg",{className:"places__sorting-arrow",width:"7",height:"4"},s.a.createElement("use",{xlinkHref:"#icon-arrow-select"}))),s.a.createElement("ul",{className:this.state.isOpen?"places__options\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaces__options--custom\n\t\t\t\t \t\t\t\t\t\t\t\t\tplaces__options--opened":"places__options\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaces__options--custom\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaces__options--closed"},s.a.createElement("li",{className:"places__option places__option--active",tabIndex:"0",onClick:this.handleClick},"Popular"),s.a.createElement("li",{className:"places__option",tabIndex:"0",onClick:this.handleClick},"Price: low to high"),s.a.createElement("li",{className:"places__option",tabIndex:"0",onClick:this.handleClick},"Price: high to low"),s.a.createElement("li",{className:"places__option",tabIndex:"0",onClick:this.handleClick},"Top rated first")))}}]),a}(s.a.PureComponent);re.propType={onChangeOption:ae.a.func.isRequired};var ne=re,ie={prefix:"property",width:31,height:33},se={prefix:"place-card",width:18,height:19},ce=function(e){var t=e.onBookmarkClick,a=e.isActive,r=e.small,n=r?se.prefix:ie.prefix,i=a?"".concat(n,"__bookmark-button--active"):"";return s.a.createElement("button",{className:"".concat(n,"__bookmark-button ").concat(i," button"),type:"button",onClick:function(){return t(r)}},s.a.createElement("svg",{className:"".concat(n,"__bookmark-icon"),width:r?se.width:ie.width,height:r?se.height:ie.height,style:a?{fill:"#4481c3",stroke:"#4481c3"}:{fill:"none",stroke:"#b8b8b8"}},s.a.createElement("use",{xlinkHref:"#icon-bookmark"})),s.a.createElement("span",{className:"visually-hidden"},"To bookmarks"))},le=function(e){var t=e.item,a=e.isFavorite,r=function(t){return e.onClick(t)};return s.a.createElement("article",{className:"cities__place-card place-card",id:t.id,onMouseOver:function(){return a=t,e.onMouseOver(a);var a},onMouseLeave:function(){return e.onMouseLeave()}},t.mark?s.a.createElement("div",{className:"place-card__mark"},s.a.createElement("span",null,t.mark)):null,s.a.createElement("div",{className:"cities__image-wrapper place-card__image-wrapper"},s.a.createElement(u.b,{to:"/offer/".concat(t.hotelId),className:"buttonLink",onClick:function(){return r(t)}},s.a.createElement("img",{className:"place-card__image",src:"/"+t.img,width:"260",height:"200",alt:"Place"}))),s.a.createElement("div",{className:"place-card__info"},s.a.createElement("div",{className:"place-card__price-wrapper"},s.a.createElement("div",{className:"place-card__price"},s.a.createElement("b",{className:"place-card__price-value"},"\u20ac",t.price),s.a.createElement("span",{className:"place-card__price-text"},"/\xa0",t.priceText)),s.a.createElement(ce,{onBookmarkClick:function(a){return function(t,a){return e.onBookmarkClick(t,a)}(t,a)},isActive:a,small:!0})),s.a.createElement("div",{className:"place-card__rating rating"},s.a.createElement("div",{className:"place-card__stars rating__stars"},s.a.createElement("span",{style:{width:"93%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating"))),s.a.createElement("h2",{className:"place-card__name"},s.a.createElement(u.b,{to:"/offer/".concat(t.hotelId),className:"card__title buttonLink",onClick:function(){return r(t)}},t.title)),s.a.createElement("p",{className:"place-card__type"},t.type)))},oe=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;Object(p.a)(this,a),(r=t.call(this,e)).handleClick=function(e){return r.props.onClick(e)},r.handleMouseOver=function(e){return r.props.onMouseOver(e)},r.handleMouseLeave=function(e){return r.props.onMouseLeave(e)},r.handleBookmarkClick=function(e,t){return r.props.onBookmarkClick(e,t)},r.isFavorite=function(e,t){if(e)return!!e.filter((function(e){return e.hotelId===t.hotelId})).length};var n=r.props.items.items;return r.state={items:n},r}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.items,r=t.favoriteList;return a.map((function(t){return s.a.createElement(le,{item:t,key:t.hotelId,isFavorite:e.isFavorite(r,t),onClick:e.handleClick,onMouseOver:e.handleMouseOver,onMouseLeave:e.handleMouseLeave,onBookmarkClick:e.handleBookmarkClick})}))}}]),a}(s.a.Component),me=function(e){var t=e.items,a=e.city,r=e.onClick;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"visually-hidden"},"Cities"),s.a.createElement("div",{className:"tabs"},s.a.createElement("section",{className:"locations container"},s.a.createElement("ul",{className:"locations__list tabs__list"},t.map((function(e,t){return s.a.createElement("li",{className:"locations__item",key:t},s.a.createElement(u.b,{to:"/",className:e.city===a?"locations__item-link tabs__item buttonLink tabs__item--active":"locations__item-link tabs__item buttonLink",style:{color:"#000",backgroundColor:"#f5f5f5"},onClick:function(){return r(e.city)},key:t},s.a.createElement("span",null,e.city)))}))))))},ue=function(e){var t=e.city;return s.a.createElement("div",{className:"cities__places-container cities__places-container--empty container"},s.a.createElement("section",{className:"cities__no-places"},s.a.createElement("div",{className:"cities__status-wrapper tabs__content"},s.a.createElement("b",{className:"cities__status"},"No places to stay available"),s.a.createElement("p",{className:"cities__status-description"},"We could not find any property availbale at the moment in ",t))),s.a.createElement("div",{className:"cities__right-section"}))},pe=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e))._initMap=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e,i=W.a.icon(K()),s=12,c=W.a.map("map",{center:n,zoom:s,zoomControl:!1,marker:!0});c.setView(n,s),W.a.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}).addTo(c);var l,o=[];a&&(i=W.a.icon(Y()),(l=W.a.marker(a.coords,{icon:i})).addTo(c));var m,u=Object(q.a)(t);try{for(u.s();!(m=u.n()).done;){var p=m.value;i=W.a.icon(K()),l=W.a.marker(p.coords,{icon:i}),o.push(l)}}catch(h){u.e(h)}finally{u.f()}for(var d=0,_=o;d<_.length;d++){var f=_[d];f.addTo(c)}r.setState({markers:o,map:c})},r._changeIconsOnHover=function(e,t){var a,r=Object(q.a)(t);try{for(r.s();!(a=r.n()).done;){var n=a.value,i=void 0;i=e&&n._latlng.lat===e.coords[0]&&n._latlng.lng===e.coords[1]?W.a.icon(K(35,35)):W.a.icon(K()),n.setIcon(i)}}catch(s){r.e(s)}finally{r.f()}},r.state={map:null,markers:[]},r}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.coords,a=e.items,r=e.offer;r?this._initMap(t,a,r):this._initMap(t,a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.coords,r=t.offerHover,n=t.items,i=t.offer,s=this.state.markers;e.offer!==i&&(this.state.map.off(),this.state.map.remove(),this._initMap(a,n,i)),e.coords!==a&&(this.state.map.off(),this.state.map.remove(),this._initMap(a,n)),this._changeIconsOnHover(r,s)}},{key:"render",value:function(){var e=this.props.items;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{id:"map"}),s.a.createElement("span",{style:{visibility:"hidden"},defaultValue:e}))}}]),a}(s.a.PureComponent),de=function(e){var t=e.isAuthorizationRequired,a=e.currentUser,r=e.onLogoClick;return s.a.createElement("header",{className:"header"},s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"header__wrapper"},s.a.createElement("div",{className:"header__left"},s.a.createElement(u.b,{to:"/",className:"header__logo-link buttonLink",onClick:r},s.a.createElement("img",{className:"header__logo",src:"/img/logo.svg",alt:"6 cities logo",width:"81",height:"41"}))),s.a.createElement("nav",{className:"header__nav"},s.a.createElement("ul",{className:"header__nav-list"},s.a.createElement("li",{className:"header__nav-item user"},s.a.createElement("button",{className:"header__nav-link header__nav-link--profile buttonLink"},s.a.createElement("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),t?s.a.createElement("span",{className:"header__login"},s.a.createElement(u.b,{to:"/login"},"Sign in")):s.a.createElement("span",{className:"header__user-name user__name"},s.a.createElement(u.b,{to:"/favorites"},a.name)))))))))},_e=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleClick=function(e){return r.props.onClick(e)},r.handleMouseOver=function(e){return r.setState((function(t){return t.hoverItem!==e?{hoverItem:e}:null}))},r.handleMouseLeave=function(){return r.setState({hoverItem:null})},r.handleCityClick=function(e){return r.props.onCityClick(e)},r.handleSortOffers=function(e){var t=r.state.offers;switch(e){case"Popular":t.sort((function(e,t){return e.id>t.id?1:e.id<t.id?-1:0}));break;case"Price: low to high":t.sort((function(e,t){return e.price>t.price?1:e.price<t.price?-1:0}));break;case"Price: high to low":t.sort((function(e,t){return e.price<t.price?1:e.price>t.price?-1:0}));break;case"Top rated first":t.sort((function(e,t){return e.rating<t.rating?1:e.rating>t.rating?-1:0}));break;default:return null}r.setState({offers:t})},r.handleBookmarkClick=function(e,t){var a=r.props,n=a.isAuthorizationRequired,i=a.toggleBookmark,s=a.favoriteList;n?window.location.assign("/login"):i(e,s)},r.state={hoverItem:null,offers:[]},r}return Object(d.a)(a,[{key:"componentDidUpdate",value:function(e){e.city!==this.props.city&&this.handleSortOffers("Popular")}},{key:"render",value:function(){var e=this.props,t=e.hotels,a=e.city,r=e.currentUser,n=e.isAuthorizationRequired,i=e.reload,c=e.favoriteList,l=X(t,a),o=t[l].offers,m=t[l].coords;return s.a.createElement("div",{className:"page page--gray page--main"},s.a.createElement(de,{isAuthorizationRequired:n,currentUser:r,onLogoClick:i}),s.a.createElement("main",{className:o.length?"page__main page__main--index":"page__main page__main--index page__main--index-empty"},s.a.createElement(me,{items:t,city:a,onClick:this.handleCityClick}),s.a.createElement("div",{className:"cities"},o.length?s.a.createElement("div",{className:"cities__places-container container"},s.a.createElement("section",{className:"cities__places places"},s.a.createElement("h2",{className:"visually-hidden"},"Places"),s.a.createElement("b",{className:"places__found"},o.length," places to stay in ",a),s.a.createElement(ne,{key:a,onChangeOption:this.handleSortOffers}),s.a.createElement("div",{className:"cities__places-list places__list tabs__content"},s.a.createElement(oe,{city:a,items:o,favoriteList:c,onClick:this.handleClick,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,onBookmarkClick:this.handleBookmarkClick}))),s.a.createElement("div",{className:"cities__right-section"},s.a.createElement("section",{className:"cities_map map"},s.a.createElement(pe,{coords:m,items:o,offerHover:this.state.hoverItem})))):s.a.createElement(ue,{city:a}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.cityOffer!==t.offers?Object(ee.a)({},t,{offers:e.cityOffers}):null}}]),a}(s.a.Component),fe=Object(n.b)((function(e,t){return Object.assign({},t,{})}),(function(e){return{toggleBookmark:function(t,a){return e(M(t,a))}}}))(_e),he=function(e){var t=e.review,a=20*t.rating;return s.a.createElement("li",{className:"reviews__item"},s.a.createElement("div",{className:"reviews__user user"},s.a.createElement("div",{className:"reviews__avatar-wrapper user__avatar-wrapper"},s.a.createElement("img",{className:"reviews__avatar user__avatar",src:"/"+t.ava,width:"54",height:"54",alt:"Reviews avatar"})),s.a.createElement("span",{className:"reviews__user-name"},t.name)),s.a.createElement("div",{className:"reviews__info"},s.a.createElement("div",{className:"reviews__rating rating"},s.a.createElement("div",{className:"reviews__stars rating__stars"},s.a.createElement("span",{style:{width:a+"%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating"))),s.a.createElement("p",{className:"reviews__text"},t.text),s.a.createElement("time",{className:"reviews__time",dateTime:t.dateTime},t.date)))},ve=function(e){var t=e.reviews;return s.a.createElement("ul",{className:"reviews__list"},t.map((function(e){return s.a.createElement(he,{review:e,key:e.id})})))},ge=function(e){var t=e.items,a=e.city,r=e.favoriteList;return s.a.createElement(oe,{city:a,items:t,favoriteList:r,onClick:function(t){return e.onClick(t)},onMouseOver:function(t){return e.onMouseOver(t)},onMouseLeave:function(t){return e.onMouseLeave(t)},onBookmarkClick:function(t,a){return e.onBookmarkClick(t,a)}})},Ee=a(18),ye=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).validateForm=function(){r.setState({disabled:!(r.state.isRatingValid&&r.state.isReviewValid)})},r.validateField=function(e,t){var a=r.state,n=a.isRatingValid,i=a.isReviewValid;switch(e){case"rating":n=t.length>0;break;case"review":i=t.length>=50&&t.length<=200}r.setState({isRatingValid:n,isReviewValid:i},(function(){return r.validateForm()}))},r.handleChange=function(e){var t=e.target,a=t.name,n=t.value;r.setState(Object(Ee.a)({},a,n),(function(){return r.validateField(a,n)}))},r.clearForm=function(e){e.target.reset(),r.setState({rating:"",review:"",isRatingValid:!1,isReviewValid:!1,disabled:!0})},r.handleSubmit=function(e){var t=r.props.onSubmit;e.preventDefault(),t({rating:r.state.rating,review:r.state.review}),r.clearForm(e)},r.state={rating:"",review:"",isRatingValid:!1,isReviewValid:!1,disabled:!0},r}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:this.handleSubmit},s.a.createElement("label",{className:"reviews__label form__label",htmlFor:"review"},"Your review"),s.a.createElement("div",{className:"reviews__rating-form form__rating"},s.a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:"5",id:"5-stars",type:"radio",onChange:this.handleChange}),s.a.createElement("label",{htmlFor:"5-stars",className:"reviews__rating-label form__rating-label",title:"perfect"},s.a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-star"}))),s.a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:"4",id:"4-stars",type:"radio",onChange:this.handleChange}),s.a.createElement("label",{htmlFor:"4-stars",className:"reviews__rating-label form__rating-label",title:"good"},s.a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-star"}))),s.a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:"3",id:"3-stars",type:"radio",onChange:this.handleChange}),s.a.createElement("label",{htmlFor:"3-stars",className:"reviews__rating-label form__rating-label",title:"not bad"},s.a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-star"}))),s.a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:"2",id:"2-stars",type:"radio",onChange:this.handleChange}),s.a.createElement("label",{htmlFor:"2-stars",className:"reviews__rating-label form__rating-label",title:"badly"},s.a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-star"}))),s.a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:"1",id:"1-star",type:"radio",onChange:this.handleChange}),s.a.createElement("label",{htmlFor:"1-star",className:"reviews__rating-label form__rating-label",title:"terribly"},s.a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-star"})))),s.a.createElement("textarea",{className:"reviews__textarea form__textarea",id:"review",placeholder:"Tell how was your stay, what you like and what can be improved",name:"review",value:this.state.textarea,onChange:this.handleChange}),s.a.createElement("div",{className:"reviews__button-wrapper"},s.a.createElement("p",{className:"reviews__help"},"To submit review please make sure to set ",s.a.createElement("span",{className:"reviews__star"},"rating")," and describe your stay with at least ",s.a.createElement("b",{className:"reviews__text-amount"},"50 characters"),"."),s.a.createElement("button",{className:"reviews__submit form__submit button",type:"submit",disabled:this.state.disabled},"Submit")))}}]),a}(s.a.PureComponent),Ne=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleClick=function(e){return r.setState({offer:e},(function(){return r.props.onClick(e)}))},r.handleMouseOver=function(e){return r.setState((function(t){return t.hoverItem!==e?{hoverItem:e}:null}))},r.handleMouseLeave=function(){return r.setState({hoverItem:null})},r.isFavorite=function(){var e=r.props,t=e.cityOffer,a=e.favoriteList;return!!a.length&&a.findIndex((function(e){return e.hotelId===t.hotelId}))>=0},r.handleBookmarkClick=function(e,t){var a=r.props,n=a.isAuthorizationRequired,i=a.cityOffer,s=a.toggleBookmark,c=a.favoriteList;n?window.location.assign("/login"):s(t?e:i,c)},r.state={hoverItem:null,offer:r.props.cityOffer},r}return Object(d.a)(a,[{key:"componentDidUpdate",value:function(e){e.cityOffer!==this.props.cityOffer&&window.scrollTo(0,0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.hotels,r=t.cityOffers,n=t.city,i=t.currentUser,c=t.isAuthorizationRequired,l=t.favoriteList,o=this.state.offer;if(!o)return null;var m=function(e,t,a){var r=[],n=W.a.latLng(e.coords);r.push({offer:e,length:0});var i,s=Object(q.a)(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(c.id!==e.id){var l=W.a.latLng(c.coords);r.push({offer:c,length:n.distanceTo(l)})}}}catch(m){s.e(m)}finally{s.f()}r=r.sort((function(e,t){return e.length-t.length}));for(var o=0;o<r.length;o++)r[o]=r[o].offer;return r.slice(1,a+1)}(o,r,3),u=function(e,t){return e[X(e,t)].coords}(a,n);return s.a.createElement("div",{className:"page"},s.a.createElement(de,{isAuthorizationRequired:c,currentUser:i}),s.a.createElement("main",{className:"page__main page__main--property"},s.a.createElement("section",{className:"property"},s.a.createElement("div",{className:"property__gallery-container container"},s.a.createElement("div",{className:"property__gallery"},s.a.createElement("div",{className:"property__image-wrapper"},s.a.createElement("img",{className:"property__image",src:"/img/room.jpg",alt:"studio"})),s.a.createElement("div",{className:"property__image-wrapper"},s.a.createElement("img",{className:"property__image",src:"/img/apartment-01.jpg",alt:"studio01"})),s.a.createElement("div",{className:"property__image-wrapper"},s.a.createElement("img",{className:"property__image",src:"/img/apartment-02.jpg",alt:"studio02"})),s.a.createElement("div",{className:"property__image-wrapper"},s.a.createElement("img",{className:"property__image",src:"/img/apartment-03.jpg",alt:"studio03"})),s.a.createElement("div",{className:"property__image-wrapper"},s.a.createElement("img",{className:"property__image",src:"/img/studio-01.jpg",alt:"studio04"})),s.a.createElement("div",{className:"property__image-wrapper"},s.a.createElement("img",{className:"property__image",src:"/img/apartment-01.jpg",alt:"studio05"})))),s.a.createElement("div",{className:"property__container container"},s.a.createElement("div",{className:"property__wrapper"},s.a.createElement("div",{className:"property__mark"},s.a.createElement("span",null,"Premium")),s.a.createElement("div",{className:"property__name-wrapper"},s.a.createElement("h1",{className:"property__name"},o.title),s.a.createElement(ce,{isActive:this.isFavorite(),onBookmarkClick:function(t){return e.handleBookmarkClick(o,t)},small:!1})),s.a.createElement("div",{className:"property__rating rating"},s.a.createElement("div",{className:"property__stars rating__stars"},s.a.createElement("span",{style:{width:"96%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating")),s.a.createElement("span",{className:"property__rating-value rating__value"},"4.8")),s.a.createElement("ul",{className:"property__features"},s.a.createElement("li",{className:"property__feature property__feature--entire"},"Entire place"),s.a.createElement("li",{className:"property__feature property__feature--bedrooms"},"3 Bedrooms"),s.a.createElement("li",{className:"property__feature property__feature--adults"},"Max 4 adults")),s.a.createElement("div",{className:"property__price"},s.a.createElement("b",{className:"property__price-value"},"\u20ac120"),s.a.createElement("span",{className:"property__price-text"},"\xa0night")),s.a.createElement("div",{className:"property__inside"},s.a.createElement("h2",{className:"property__inside-title"},"What's inside"),s.a.createElement("ul",{className:"property__inside-list"},s.a.createElement("li",{className:"property__inside-item"},"Wi-Fi"),s.a.createElement("li",{className:"property__inside-item"},"Washing machine"),s.a.createElement("li",{className:"property__inside-item"},"Towels"),s.a.createElement("li",{className:"property__inside-item"},"Heating"),s.a.createElement("li",{className:"property__inside-item"},"Coffee machine"),s.a.createElement("li",{className:"property__inside-item"},"Baby seat"),s.a.createElement("li",{className:"property__inside-item"},"Kitchen"),s.a.createElement("li",{className:"property__inside-item"},"Dishwasher"),s.a.createElement("li",{className:"property__inside-item"},"Cabel TV"),s.a.createElement("li",{className:"property__inside-item"},"Fridge"))),s.a.createElement("div",{className:"property__host"},s.a.createElement("h2",{className:"property__host-title"},"Meet the host"),s.a.createElement("div",{className:"property__host-user user"},s.a.createElement("div",{className:"property__avatar-wrapper property__avatar-wrapper--pro user__avatar-wrapper"},s.a.createElement("img",{className:"property__avatar user__avatar",src:"/img/avatar-angelina.jpg",width:"74",height:"74",alt:"Host avatar"})),s.a.createElement("span",{className:"property__user-name"},"Angelina"),s.a.createElement("span",{className:"property__user-status"},"Pro")),s.a.createElement("div",{className:"property__description"},s.a.createElement("p",{className:"property__text"},"A quiet cozy and picturesque that hides behind a a river by the unique lightness of Amsterdam. The building is green and from 18th century."),s.a.createElement("p",{className:"property__text"},"An independent House, strategically located between Rembrand Square and National Opera, but where the bustle of the city comes to rest in this alley flowery and colorful."))),s.a.createElement("section",{className:"property__reviews reviews"},s.a.createElement("h2",{className:"reviews__title"},"Reviews \xb7 ",s.a.createElement("span",{className:"reviews__amount"},o.reviews.length)),s.a.createElement(ve,{reviews:o.reviews}),c?null:s.a.createElement(ye,{onSubmit:this.submitReviewForm})))),s.a.createElement("section",{className:"property_map map",style:{height:"579px",marginBottom:"50px"}},s.a.createElement(pe,{coords:u,items:m,offerHover:this.state.hoverItem,offer:o}))),s.a.createElement("div",{className:"container"},s.a.createElement("section",{className:"near-places places"},s.a.createElement("h2",{className:"near-places__title"},"Other places in the neighbourhood"),s.a.createElement("div",{className:"near-places__list places__list"},s.a.createElement(ge,{city:n,items:m,favoriteList:l,onClick:this.handleClick,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,onBookmarkClick:this.handleBookmarkClick}))))))}}]),a}(s.a.PureComponent),ke=Object(n.b)((function(e,t){var a=t.match.params.id;return Object.assign({},t,{id:a,city:Z(e,a).city,hotels:e.hotels,cityOffer:Z(e,a),cityOffers:$(e,a),favoriteList:e.favoriteList,isAuthorizationRequired:e.isAuthorizationRequired,currentUser:e.currentUser})}),(function(e){return{onClick:function(t){return e(x(t))},toggleBookmark:function(t,a){return e(M(t,a))}}}))(Ne),be=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleSubmit=function(e){var t=r.props.onSubmit;e.preventDefault(),t({email:r.state.email,password:r.state.password})},r.validateField=function(e,t){var a=r.state.emailValid,n=r.state.passwordValid;switch(e){case"email":a=t.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i);break;case"password":n=t.length>=6&&t.length<=12}r.setState({emailValid:a,passwordValid:n},r.validateForm)},r.validateForm=function(){r.setState({formValid:r.state.emailValid&&r.state.passwordValid})},r.handleChange=function(e){var t=e.target.value,a=e.target.name;r.setState(Object(Ee.a)({},a,t),(function(){r.validateField(a,t)}))},r.handleCityClick=function(e){return r.props.onCityClick(e)},r.state={email:"",password:"",emailValid:!1,passwordValid:!1,formValid:!1},r}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.isAuthRequired,r=t.currentUser;return s.a.createElement("div",{className:"page page--gray page--login"},s.a.createElement(de,{isAuthorizationRequired:a,currentUser:r,onLogoClick:function(){return e.handleCityClick("Paris")}}),s.a.createElement("main",{className:"page__main page__main--login"},s.a.createElement("div",{className:"page__login-container container"},s.a.createElement("section",{className:"login"},s.a.createElement("h1",{className:"login__title"},"Sign in"),s.a.createElement("form",{className:"login__form form",action:"#",method:"post",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"login__input-wrapper form__input-wrapper"},s.a.createElement("label",{className:"visually-hidden"},"E-mail"),s.a.createElement("input",{className:"login__input form__input",type:"email",name:"email",placeholder:"Email",required:"",value:this.state.email,onChange:this.handleChange})),s.a.createElement("div",{className:"login__input-wrapper form__input-wrapper"},s.a.createElement("label",{className:"visually-hidden"},"Password"),s.a.createElement("input",{className:"login__input form__input",type:"password",name:"password",placeholder:"Password",required:"",value:this.state.password,onChange:this.handleChange})),s.a.createElement("button",{className:"login__submit form__submit button",type:"submit",disabled:!this.state.formValid},"Sign in"))),s.a.createElement("section",{className:"locations locations--login locations--current"},s.a.createElement("div",{className:"locations__item"},s.a.createElement("button",{className:"locations__item-link buttonLink"},s.a.createElement("span",null,"Amsterdam")))))))}}]),a}(s.a.PureComponent),we=function(e){var t=e.city,a=e.onFavoriteCityClick;return s.a.createElement("div",{className:"favorites__locations locations locations--current"},s.a.createElement("div",{className:"locations__item"},s.a.createElement(u.b,{to:"/",className:"locations__item-link buttonLink",onClick:function(){return a(t)}},s.a.createElement("span",null,t))))},Oe=function(e){var t=e.item;return s.a.createElement("article",{className:"favorites__card place-card"},s.a.createElement("div",{className:"favorites__image-wrapper place-card__image-wrapper"},s.a.createElement(u.b,{to:"/offer/".concat(t.hotelId),className:"buttonLink"},s.a.createElement("img",{className:"place-card__image",src:"/"+t.img,width:"150",height:"110",alt:"Place"}))),s.a.createElement("div",{className:"favorites__card-info place-card__info"},s.a.createElement("div",{className:"place-card__price-wrapper"},s.a.createElement("div",{className:"place-card__price"},s.a.createElement("b",{className:"place-card__price-value"},"\u20ac",t.price),s.a.createElement("span",{className:"place-card__price-text"},"/\xa0",t.priceText)),s.a.createElement(ce,{onBookmarkClick:function(){return e.onBookmarkClick(e.item)},isActive:!0,small:!0})),s.a.createElement("div",{className:"place-card__rating rating"},s.a.createElement("div",{className:"place-card__stars rating__stars"},s.a.createElement("span",{style:{width:"100%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating"))),s.a.createElement("h2",{className:"place-card__name"},s.a.createElement(u.b,{to:"/offer/".concat(t.hotelId),className:"card__title buttonLink"},t.title)),s.a.createElement("p",{className:"place-card__type"},t.type)))},Ce=function(e){var t=e.favoriteList,a=e.onBookmarkClick,r=e.onFavoriteCityClick,n=function(e){return a(e)},i=function(e){return r(e)};return s.a.createElement("ul",{className:"favorites__list"},t.map((function(e,t){return s.a.createElement("li",{className:"favorites__locations-items",key:e.city+t},s.a.createElement(we,{city:e.city,key:e.city+t,onFavoriteCityClick:i,prefix:"favorites"}),s.a.createElement("div",{className:"favorites__places"},e.favorites.map((function(e){return s.a.createElement(Oe,{item:e,key:e.hotelId,onBookmarkClick:n})}))))})))},Le=function(e){var t=new Set,a=[],r={city:"",favorites:[]};e.forEach((function(e){return t.add(e.city)}));var n,i=Object(q.a)(t);try{for(i.s();!(n=i.n()).done;){var s,c=n.value,l=Object(q.a)(e);try{for(l.s();!(s=l.n()).done;){var o=s.value;c===o.city&&(r.city=c,r.favorites.push(o))}}catch(m){l.e(m)}finally{l.f()}a.push(r),r={city:"",favorites:[]}}}catch(m){i.e(m)}finally{i.f()}return a},je=Object(n.b)((function(e,t){return Object.assign({},t,{})}),(function(e){return{cityClick:function(t){return e(I(t))},toggleBookmark:function(t,a){return e(M(t,a))}}}))((function(e){var t=e.favoriteList,a=e.toggleBookmark,r=e.cityClick,n=e.isAuthRequired,i=e.currentUser;return s.a.createElement("div",{className:"page ".concat(t.length?"":"page--favorites-empty")},s.a.createElement(de,{isAuthorizationRequired:n,currentUser:i}),t.length?s.a.createElement("main",{className:"page__main page__main--favorites"},s.a.createElement("div",{className:"page__favorites-container container"},s.a.createElement("section",{className:"favorites"},s.a.createElement("h1",{className:"favorites__title"},"Saved listing"),s.a.createElement(Ce,{favoriteList:Le(t),onBookmarkClick:function(e){return a(e,t)},onFavoriteCityClick:function(e){return r(e)}})))):s.a.createElement("main",{className:"page__main page__main--favorites page__main--favorites-empty"},s.a.createElement("div",{className:"page__favorites-container container"},s.a.createElement("section",{className:"favorites favorites--empty"},s.a.createElement("h1",{className:"visually-hidden"},"Favorites (empty)"),s.a.createElement("div",{className:"favorites__status-wrapper"},s.a.createElement("b",{className:"favorites__status"},"Nothing yet saved."),s.a.createElement("p",{className:"favorites__status-description"},"Save properties to narrow down search or plan yor future trips."))))),s.a.createElement("footer",{className:"footer"},s.a.createElement(u.b,{to:"/",className:"footer__logo-link",href:"main.html"},s.a.createElement("img",{className:"footer__logo",src:"img/logo.svg",alt:"6 cities logo",width:"64",height:"33"}))))})),Se=function(){return s.a.createElement("div",{id:"preloader"},s.a.createElement("div",{id:"loader"}))},Re=function(e){Object(f.a)(a,e);var t=Object(_.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleReload=function(){r.setState((function(e){return{isHotelsLoaded:!e.isHotelsLoaded}}),(function(){return window.location.reload()}))},r.handleOfferClick=function(e){return r.setState({activeOfferId:e.id})},r.state={activeOfferId:{},isHotelsLoaded:!1},r}return Object(d.a)(a,[{key:"componentDidUpdate",value:function(e){var t,a=this.props,r=a.hotels,n=a.currentUser,i=a.favoriteList;if(e.hotels!==r&&this.setState({isHotelsLoaded:!0}),n&&e.favoriteList!==i){var s,c=[],l={currentUser:n,favoriteList:i},o=(t="favorites",JSON.parse(localStorage.getItem(t)));o?((s=o.filter((function(e){return e.currentUser.email!==n.email}))).push(l),G("favorites",s)):(c.push(l),G("favorites",c))}}},{key:"render",value:function(){var e,t=this.props,a=t.hotels,r=t.city,n=t.currentUser,i=t.isAuthorizationRequired,c=t.favoriteList,l=t.cityClick,o=t.login;return this.state.isHotelsLoaded&&r&&(e=a[X(a,r)].offers),this.state.isHotelsLoaded&&r?s.a.createElement(h.b,{history:g},s.a.createElement(h.c,null,s.a.createElement(h.a,{exact:!0,path:P},s.a.createElement(fe,Object.assign({},this.props,{cityOffers:e,onClick:this.handleOfferClick,onCityClick:l,reload:this.handleReload}))),s.a.createElement(h.a,{exact:!0,path:H},s.a.createElement(be,{onSubmit:o,onCityClick:l,currentUser:n,isAuthRequired:i})),s.a.createElement(h.a,{exact:!0,path:D},s.a.createElement(je,{favoriteList:c,isAuthRequired:i,currentUser:n})),s.a.createElement(h.a,{path:z,render:function(e){return s.a.createElement(ke,e)}}))):s.a.createElement(Se,null)}}]),a}(s.a.PureComponent),Ie=Object(n.b)((function(e,t){return Object.assign({},t,{city:e.city,hotels:e.hotels,currentOffer:e.currentOffer,favoriteList:e.favoriteList,isAuthorizationRequired:e.isAuthorizationRequired,currentUser:e.currentUser})}),(function(e){return{reloadAll:function(){return e(B.reloadAll())},cityClick:function(t){return e(I(t))},onClick:function(t){return e(x(t))},login:function(t){return e(B.login(t))},setFavorites:function(t){return e(U(t))},setCurrentUser:function(t){return e(F(t))}}}))(Re),Ae=a(45),xe=a.n(Ae),Te=function(e){var t=xe.a.create({baseURL:"https://es31-server.appspot.com/six-cities",timeout:5e3,withCredentials:!0});return t.interceptors.response.use((function(e){return e}),(function(t){return 403===t.response.status&&e(),t})),t};!function(){var e=Te((function(){t.dispatch(T(!0))})),t=Object(r.c)(V,Object(m.a)(Object(r.a)(o.a.withExtraArgument(e)),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e}));t.dispatch(B.loadHotels()).then((function(){var e=t.getState().hotels[0].city;e&&t.dispatch(I(e))})),t.dispatch(B.checkAuth()),l.a.render(s.a.createElement(n.a,{store:t},s.a.createElement(u.a,null,s.a.createElement(Ie,null))),document.getElementById("root"))}()}},[[47,1,2]]]);
//# sourceMappingURL=main.02cbdcb9.chunk.js.map